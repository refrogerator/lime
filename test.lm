--
-- main :: Bool
-- main = True

-- __add a b = 4

-- p :: Float

-- joe a = case a of
--     3 -> 4
--     4 -> 5
--

-- bean :: Bool -> Int
-- bean a = case a of
--     True -> 6
--     False -> 7
--

-- data Test = Test Bool Int | Joe
--
-- amogus :: Test -> Int
-- amogus a = case a of
--     Test _ v -> v
--     Joe -> 4

--
-- gaming :: Bool -> a -> a -> a
-- gaming a b c = case a of
--     True -> b
--     False -> c

-- data List a = Cons a (List a) | Nil

-- funny n = case n of
--     Cons i l -> i + funny l
--     Nil -> 0

-- funny :: List Int -> Int
-- funny n = case n of
--     Cons i l -> i + funny l
--     Nil -> 0

-- funny1 :: List Int -> Int
-- funny1 n = case n of
--     Cons i l -> i + funny1 l
--     Nil -> 0

-- main = (Cons 1 (Cons True (Cons 3 Nil)))
-- main = funny (Cons (funny1 (Cons 1 Nil)) (Cons 2 (Cons 3 Nil)))

-- ones :: List Int
-- ones = Cons 1 ones

-- main = 2 + let a = 4
--                b = 5
--     in a + b



-- main = 2 + let 
--     a b = 
--         4 + b
--     in a 3

-- main = funny (Cons 1 (Cons 2 (Cons 3 Nil)))

-- main = funny ones
-- main = Cons 1 Nil
-- main = 1

-- main = gaming True 6 7

data Bool
    = True
    | False

data List a = Cons a (List a) | Nil

-- class Show a where
--     show :: a -> List Char
--
-- instance Show Bool where
--     show a = case a of
--         True -> Cons 'T' (Cons 'r' (Cons 'u' (Cons 'e' Nil)))
--         False -> Cons 'F' (Cons 'a' (Cons 'l' (Cons 's' (Cons 'e' Nil))))

data IOHelper a = IOHelper World a

type IO a = World -> IOHelper a

primIO :: a -> IO a
primIO a = \w -> IOHelper w a

bind :: IO a -> (a -> IO b) -> IO b
bind a f = \w -> case a w of
    IOHelper w2 g -> f g w2

-- class Monad m where
--     bind :: m a -> (a -> m b) -> m b
--     return :: a -> m a

-- instance Monad IO where
--     bind = ioBind
--     return = primIO

__printChar :: Char -> Unit

printChar :: Char -> IO Unit
printChar c = primIO (__printChar c)

__printString :: String -> Unit

putStr :: String -> IO Unit
putStr s = primIO (__printString s)

putStrLn :: String -> IO Unit
putStrLn s = bind (putStr s) (\a -> printChar '\n')

main = putStrLn "test"

--
-- bind a b = \x -> b (a x)

-- print :: List Char -> IO Unit
-- print n = case n of
--     Cons i l -> bind (printChar i) (\x -> (print l))
--     Nil -> printChar '\n'
--
-- main = print (show True)

-- main :: IO Unit

-- pt = __printChar 't'
-- pr :: Unit -> IO Unit
-- pr a = __printChar 'r'
--
-- ba = bind pt
-- bb = ba pr

-- main = bb
-- main = bind (printChar 't') (\x -> printChar 'r')

-- class Eq a where
--     eq :: a -> a -> Bool
--
-- instance Eq Bool where
--     eq a b = case a of
--         True -> case b of
--             True -> True
--             False -> False
--         False -> case b of
--             True -> False
--             False -> True

-- const :: a -> b -> a
-- const a b = a

-- main :: Int

-- main = 1 + 2
-- main = eq False True
-- main = const 1 2
-- main = True 4
-- main = Test False 20
-- main = const 1 (const 2 3)

-- id :: a -> a
-- id a = a

-- main = 20

-- joe a b = a + b
